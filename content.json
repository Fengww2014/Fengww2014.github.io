{"pages":[{"title":"about","text":"Itâ€™s never too old to learn","link":"/about/index.html"}],"posts":[{"title":"HTTPå…¨è§£","text":"httpæ˜¯ç›®å‰è®¿é—®ç½‘é¡µæœ€ä¸»æµçš„åº”ç”¨å±‚åè®®ï¼Œä½†æ˜¯å¯¹äºhttpåº”ç”¨å±‚å’Œä¸‹é¢çš„ä¼ è¾“å±‚ä¹‹é—´çš„å…³ç³»ï¼Œä¸€ç›´ä¸æ˜¯ç‰¹åˆ«çš„æ¸…æ¥šï¼Œé‚å°±æœ¬æ–‡å¯¹httpåè®®ä»ç½‘ç»œå±‚æ¬¡çš„è§’åº¦æ¥ä»”ç»†å‰–æï¼Œå¹¶å†™äº†pythonè„šæœ¬è¯•å›¾å¤åŸæ•´ä¸ªçš„httpè¯·æ±‚å…¨æµç¨‹ã€‚ 1. ç”¨scapyå®ç°httpè¯·æ±‚å…¨æµç¨‹1.1 httpè¯·æ±‚å’Œå“åº”çš„å…¨æµç¨‹ä¸»è¦çš„æ­¥éª¤åŒ…æ‹¬å»ºç«‹è¿æ¥ã€http requestå’Œresponseäº¤äº’ã€å…³é—­è¿æ¥ç­‰ï¼Œä¸‹é¢é€ä¸€è®²è§£ã€‚ 1.2 TCP/IPåè®®TCP/IPåè®®æ¨¡å‹ï¼ˆTransmission Control Protocol/Internet Protocolï¼‰ï¼ŒåŒ…å«äº†ä¸€ç³»åˆ—æ„æˆäº’è”ç½‘åŸºç¡€çš„ç½‘ç»œåè®®ï¼Œæ˜¯Internetçš„æ ¸å¿ƒåè®®ï¼Œé€šè¿‡20å¤šå¹´çš„å‘å±•å·²æ—¥æ¸æˆç†Ÿï¼Œå¹¶è¢«å¹¿æ³›åº”ç”¨äºå±€åŸŸç½‘å’Œå¹¿åŸŸç½‘ä¸­ï¼ˆå¦‚æœå±€åŸŸç½‘æ˜¯å°æºªï¼Œå¾ˆå¤šæ¡å°æºªå°±æ±‡èšæˆå¤§çš„å¹²æµï¼Œæ¯”å¦‚é•¿æ±Ÿã€é»„æ²³ï¼Œå¹²æµå°±æ˜¯å¹¿åŸŸç½‘ï¼Œç„¶åå†æµå…¥å¤§æµ·ï¼Œå¤§æµ·å°±æ˜¯äº’è”ç½‘ï¼‰ï¼Œç›®å‰å·²æˆä¸ºäº‹å®ä¸Šçš„å›½é™…æ ‡å‡†ã€‚TCP/IPåè®®ç°‡æ˜¯ä¸€ç»„ä¸åŒå±‚æ¬¡ä¸Šçš„å¤šä¸ªåè®®çš„ç»„åˆï¼Œé€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå››å±‚åè®®ç³»ç»Ÿï¼Œä¸OSIçš„ä¸ƒå±‚æ¨¡å‹ç›¸å¯¹åº”ã€‚ HTTPåè®®å°±æ˜¯åŸºäºTCP/IPåè®®æ¨¡å‹æ¥ä¼ è¾“ä¿¡æ¯çš„ï¼Œhttpåè®®æ˜¯æ— çŠ¶æ€ï¼Œé¢å‘è¿æ¥çš„ï¼Œä½äºåº”ç”¨å±‚çš„åè®®ã€‚ä¸‹é¢çš„æ€ç»´å¯¼å›¾æ˜¯tcp/ipæ¶‰åŠåˆ°çš„çŸ¥è¯†æ¡†æ¶ã€‚ (1). é“¾è·¯å±‚ä¹Ÿç§°ä½œæ•°æ®é“¾è·¯å±‚æˆ–ç½‘ç»œæ¥å£å±‚ï¼ˆåœ¨ç¬¬ä¸€ä¸ªå›¾ä¸­ä¸ºç½‘ç»œæ¥å£å±‚å’Œç¡¬ä»¶å±‚ï¼‰ï¼Œé€šå¸¸åŒ…æ‹¬æ“ä½œç³»ç»Ÿä¸­çš„è®¾å¤‡é©±åŠ¨ç¨‹åºå’Œè®¡ç®—æœºä¸­å¯¹åº”çš„ç½‘ç»œæ¥å£å¡ã€‚å®ƒä»¬ä¸€èµ·å¤„ç†ä¸ç”µç¼†ï¼ˆæˆ–å…¶ä»–ä»»ä½•ä¼ è¾“åª’ä»‹ï¼‰çš„ç‰©ç†æ¥å£ç»†èŠ‚ã€‚ARPï¼ˆåœ°å€è§£æåè®®ï¼‰å’ŒRARPï¼ˆé€†åœ°å€è§£æåè®®ï¼‰æ˜¯æŸäº›ç½‘ç»œæ¥å£ï¼ˆå¦‚ä»¥å¤ªç½‘å’Œä»¤ç‰Œç¯ç½‘ï¼‰ä½¿ç”¨çš„ç‰¹æ®Šåè®®ï¼Œç”¨æ¥è½¬æ¢IPå±‚å’Œç½‘ç»œæ¥å£å±‚ä½¿ç”¨çš„åœ°å€ã€‚ (2). ç½‘ç»œå±‚ä¹Ÿç§°ä½œäº’è”ç½‘å±‚ï¼ˆåœ¨ç¬¬ä¸€ä¸ªå›¾ä¸­ä¸ºç½‘é™…å±‚ï¼‰ï¼Œå¤„ç†åˆ†ç»„åœ¨ç½‘ç»œä¸­çš„æ´»åŠ¨ï¼Œä¾‹å¦‚åˆ†ç»„çš„é€‰è·¯ã€‚åœ¨TCP/IPåè®®æ—ä¸­ï¼Œç½‘ç»œå±‚åè®®åŒ…æ‹¬IPåè®®ï¼ˆç½‘é™…åè®®ï¼‰ï¼ŒICMPåè®®ï¼ˆInternetäº’è”ç½‘æ§åˆ¶æŠ¥æ–‡åè®®ï¼‰ï¼Œä»¥åŠIGMPåè®®ï¼ˆInternetç»„ç®¡ç†åè®®ï¼‰ã€‚ IPæ˜¯ä¸€ç§ç½‘ç»œå±‚åè®®ï¼Œæä¾›çš„æ˜¯ä¸€ç§ä¸å¯é çš„æœåŠ¡ï¼Œå®ƒåªæ˜¯å°½å¯èƒ½å¿«åœ°æŠŠåˆ†ç»„ä»æºç»“ç‚¹é€åˆ°ç›®çš„ç»“ç‚¹ï¼Œä½†æ˜¯å¹¶ä¸æä¾›ä»»ä½•å¯é æ€§ä¿è¯ã€‚åŒæ—¶è¢«TCPå’ŒUDPä½¿ç”¨ã€‚TCPå’ŒUDPçš„æ¯ç»„æ•°æ®éƒ½é€šè¿‡ç«¯ç³»ç»Ÿå’Œæ¯ä¸ªä¸­é—´è·¯ç”±å™¨ä¸­çš„IPå±‚åœ¨äº’è”ç½‘ä¸­è¿›è¡Œä¼ è¾“ã€‚ ICMPæ˜¯IPåè®®çš„é™„å±åè®®ã€‚IPå±‚ç”¨å®ƒæ¥ä¸å…¶ä»–ä¸»æœºæˆ–è·¯ç”±å™¨äº¤æ¢é”™è¯¯æŠ¥æ–‡å’Œå…¶ä»–é‡è¦ä¿¡æ¯ã€‚ IGMPæ˜¯Internetç»„ç®¡ç†åè®®ã€‚å®ƒç”¨æ¥æŠŠä¸€ä¸ªUDPæ•°æ®æŠ¥å¤šæ’­åˆ°å¤šä¸ªä¸»æœºã€‚ (3). ä¼ è¾“å±‚ä¸»è¦ä¸ºä¸¤å°ä¸»æœºä¸Šçš„åº”ç”¨ç¨‹åºæä¾›ç«¯åˆ°ç«¯çš„é€šä¿¡ã€‚åœ¨TCP/IPåè®®æ—ä¸­ï¼Œæœ‰ä¸¤ä¸ªäº’ä¸ç›¸åŒçš„ä¼ è¾“åè®®ï¼šTCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰å’ŒUDPï¼ˆç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰ã€‚ TCPä¸ºä¸¤å°ä¸»æœºæä¾›é«˜å¯é æ€§çš„æ•°æ®é€šä¿¡ã€‚å®ƒæ‰€åšçš„å·¥ä½œåŒ…æ‹¬æŠŠåº”ç”¨ç¨‹åºäº¤ç»™å®ƒçš„æ•°æ®åˆ†æˆåˆé€‚çš„å°å—äº¤ç»™ä¸‹é¢çš„ç½‘ç»œå±‚ï¼Œç¡®è®¤æ¥æ”¶åˆ°çš„åˆ†ç»„ï¼Œè®¾ç½®å‘é€æœ€åç¡®è®¤åˆ†ç»„çš„è¶…æ—¶æ—¶é’Ÿç­‰ã€‚ç”±äºè¿è¾“å±‚æä¾›äº†é«˜å¯é æ€§çš„ç«¯åˆ°ç«¯çš„é€šä¿¡ï¼Œå› æ­¤åº”ç”¨å±‚å¯ä»¥å¿½ç•¥æ‰€æœ‰è¿™äº›ç»†èŠ‚ã€‚ä¸ºäº†æä¾›å¯é çš„æœåŠ¡ï¼ŒTCPé‡‡ç”¨äº†è¶…æ—¶é‡ä¼ ã€å‘é€å’Œæ¥æ”¶ç«¯åˆ°ç«¯çš„ç¡®è®¤åˆ†ç»„ç­‰æœºåˆ¶ã€‚ UDPåˆ™ä¸ºåº”ç”¨å±‚æä¾›ä¸€ç§éå¸¸ç®€å•çš„æœåŠ¡ã€‚å®ƒåªæ˜¯æŠŠç§°ä½œæ•°æ®æŠ¥çš„åˆ†ç»„ä»ä¸€å°ä¸»æœºå‘é€åˆ°å¦ä¸€å°ä¸»æœºï¼Œä½†å¹¶ä¸ä¿è¯è¯¥æ•°æ®æŠ¥èƒ½åˆ°è¾¾å¦ä¸€ç«¯ã€‚ä¸€ä¸ªæ•°æ®æŠ¥æ˜¯æŒ‡ä»å‘é€æ–¹ä¼ è¾“åˆ°æ¥æ”¶æ–¹çš„ä¸€ä¸ªä¿¡æ¯å•å…ƒï¼ˆä¾‹å¦‚ï¼Œå‘é€æ–¹æŒ‡å®šçš„ä¸€å®šå­—èŠ‚æ•°çš„ä¿¡æ¯ï¼‰ã€‚UDPåè®®ä»»ä½•å¿…éœ€çš„å¯é æ€§å¿…é¡»ç”±åº”ç”¨å±‚æ¥æä¾›ã€‚ (4). åº”ç”¨å±‚åº”ç”¨å±‚å†³å®šäº†å‘ç”¨æˆ·æä¾›åº”ç”¨æœåŠ¡æ—¶é€šä¿¡çš„æ´»åŠ¨ã€‚TCP/IP åè®®æ—å†…é¢„å­˜äº†å„ç±»é€šç”¨çš„åº”ç”¨æœåŠ¡ã€‚åŒ…æ‹¬ HTTPï¼ŒFTPï¼ˆFile Transfer Protocolï¼Œæ–‡ä»¶ä¼ è¾“åè®®ï¼‰ï¼ŒDNSï¼ˆDomain Name Systemï¼ŒåŸŸåç³»ç»Ÿï¼‰æœåŠ¡ã€‚ æ•°æ®åŒ…è¿›å…¥åˆ°æ¯ä¸€ä¸ªå±‚ï¼Œéƒ½ä¼šè¢«åŠ ä¸Šç›¸åº”çš„å¤´éƒ¨ï¼Œå„å±‚çš„åè®®å°±æ˜¯æ•°æ®åŒ…å¤´éƒ¨çš„è§„èŒƒï¼Œæ˜¯ç»Ÿä¸€çš„æ•°æ®åŒ…ç»“æ„è¯´æ˜ã€‚ åŒ…å¯ä»¥è¯´æ˜¯å…¨èƒ½æ€§æœ¯è¯­ï¼› å¸§ç”¨äºè¡¨ç¤ºæ•°æ®é“¾è·¯å±‚ä¸­åŒ…çš„å•ä½ï¼› æ•°æ®åŒ…æ˜¯ IP å’Œ UDP ç­‰ç½‘ç»œå±‚ä»¥ä¸Šçš„åˆ†å±‚ä¸­åŒ…çš„å•ä½ï¼› æ®µåˆ™è¡¨ç¤º TCP æ•°æ®æµä¸­çš„ä¿¡æ¯ï¼› æ¶ˆæ¯æ˜¯æŒ‡åº”ç”¨åè®®ä¸­æ•°æ®çš„å•ä½ ä»TCP/IPæ¨¡å‹çš„è§’åº¦æ¥ç†è§£äº†ä¸€æ¬¡HTTPè¯·æ±‚ä¸å“åº”çš„è¿‡ç¨‹ ä¸‹é¢å†çœ‹ä¸Šé¢çš„çš„ï¼›æµç¨‹æ˜¯å¦‚ä½•ä¸€æ­¥ä¸€æ­¥å®Œæˆçš„ï¼Œå„ä¸ªå±‚åˆ†åˆ«åšäº†ä»€ä¹ˆä½œç”¨ã€‚ 1.3 TCPä¸‰æ¬¡æ¡æ‰‹ HTTPåŸºæœ¬éƒ½æ˜¯åŸºäºTCPçš„ï¼ŒTCPæ˜¯é¢å‘è¿æ¥çš„ï¼Œæ— è®ºå“ªä¸€æ–¹å‘å¦ä¸€æ–¹å‘é€æ•°æ®ä¹‹å‰ï¼Œéƒ½å¿…é¡»å…ˆåœ¨åŒæ–¹ä¹‹é—´å»ºç«‹ä¸€æ¡è¿æ¥ã€‚åœ¨TCP/IPåè®®ä¸­ï¼ŒTCPåè®®æä¾›å¯é çš„è¿æ¥æœåŠ¡ï¼Œè¿æ¥æ˜¯é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹è¿›è¡Œåˆå§‹åŒ–çš„ã€‚ä¸‰æ¬¡æ¡æ‰‹çš„ç›®çš„æ˜¯åŒæ­¥è¿æ¥åŒæ–¹çš„åºåˆ—å·å’Œç¡®è®¤å·å¹¶äº¤æ¢ TCPçª—å£å¤§å°ä¿¡æ¯ã€‚ ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå»ºç«‹è¿æ¥ã€‚å®¢æˆ·ç«¯å‘é€è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå°†SYNä½ç½®ä¸º1ï¼ŒSequence Numberä¸ºxï¼›ç„¶åï¼Œå®¢æˆ·ç«¯è¿›å…¥SYN_SENDçŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨çš„ç¡®è®¤ï¼› ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°SYNæŠ¥æ–‡æ®µã€‚æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„SYNæŠ¥æ–‡æ®µï¼Œéœ€è¦å¯¹è¿™ä¸ªSYNæŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤ï¼Œè®¾ç½®Acknowledgment Numberä¸ºx+1(Sequence Number+1)ï¼›åŒæ—¶ï¼Œè‡ªå·±è‡ªå·±è¿˜è¦å‘é€SYNè¯·æ±‚ä¿¡æ¯ï¼Œå°†SYNä½ç½®ä¸º1ï¼ŒSequence Numberä¸ºyï¼›æœåŠ¡å™¨ç«¯å°†ä¸Šè¿°æ‰€æœ‰ä¿¡æ¯æ”¾åˆ°ä¸€ä¸ªæŠ¥æ–‡æ®µï¼ˆå³SYN+ACKæŠ¥æ–‡æ®µï¼‰ä¸­ï¼Œä¸€å¹¶å‘é€ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥SYN_RECVçŠ¶æ€ï¼› ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„SYN+ACKæŠ¥æ–‡æ®µã€‚ç„¶åå°†Acknowledgment Numberè®¾ç½®ä¸ºy+1ï¼Œå‘æœåŠ¡å™¨å‘é€ACKæŠ¥æ–‡æ®µï¼Œè¿™ä¸ªæŠ¥æ–‡æ®µå‘é€å®Œæ¯•ä»¥åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½è¿›å…¥ESTABLISHEDçŠ¶æ€ï¼Œå®ŒæˆTCPä¸‰æ¬¡æ¡æ‰‹ã€‚ ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹ ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ï¼š å…·ä½“ä¾‹å­ï¼šâ€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€çš„äº§ç”Ÿåœ¨è¿™æ ·ä¸€ç§æƒ…å†µä¸‹ï¼šclientå‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œç»“ç‚¹é•¿æ—¶é—´çš„æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾serverã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½†serveræ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯è®¤ä¸ºæ˜¯clientå†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿æ¥è¯·æ±‚ã€‚äºæ˜¯å°±å‘clientå‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚å‡è®¾ä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦serverå‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿æ¥å°±å»ºç«‹äº†ã€‚ç”±äºç°åœ¨clientå¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼Œå› æ­¤ä¸ä¼šç†ç¬serverçš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘serverå‘é€æ•°æ®ã€‚ä½†serverå´ä»¥ä¸ºæ–°çš„è¿è¾“è¿æ¥å·²ç»å»ºç«‹ï¼Œå¹¶ä¸€ç›´ç­‰å¾…clientå‘æ¥æ•°æ®ã€‚è¿™æ ·ï¼Œserverçš„å¾ˆå¤šèµ„æºå°±ç™½ç™½æµªè´¹æ‰äº†ã€‚é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€çš„åŠæ³•å¯ä»¥é˜²æ­¢ä¸Šè¿°ç°è±¡å‘ç”Ÿã€‚ä¾‹å¦‚åˆšæ‰é‚£ç§æƒ…å†µï¼Œclientä¸ä¼šå‘serverçš„ç¡®è®¤å‘å‡ºç¡®è®¤ã€‚serverç”±äºæ”¶ä¸åˆ°ç¡®è®¤ï¼Œå°±çŸ¥é“clientå¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¿æ¥ã€‚â€ 1.4 HTTPåè®®Httpæ˜¯ä»€ä¹ˆï¼Ÿé€šä¿—æ¥è®²ï¼Œä»–å°±æ˜¯è®¡ç®—æœºé€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡çš„è§„åˆ™ï¼Œæ˜¯ä¸€ä¸ªåŸºäºè¯·æ±‚ä¸å“åº”ï¼Œæ— çŠ¶æ€çš„ï¼Œåº”ç”¨å±‚çš„åè®®ï¼Œå¸¸åŸºäºTCP/IPåè®®ä¼ è¾“æ•°æ®ã€‚ç›®å‰ä»»ä½•ç»ˆç«¯ï¼ˆæ‰‹æœºï¼Œç¬”è®°æœ¬ç”µè„‘ã€‚ã€‚ï¼‰ä¹‹é—´è¿›è¡Œä»»ä½•ä¸€ç§é€šä¿¡éƒ½å¿…é¡»æŒ‰ç…§Httpåè®®è¿›è¡Œï¼Œå¦åˆ™æ— æ³•è¿æ¥ã€‚ å››ä¸ªåŸºäºï¼š è¯·æ±‚ä¸å“åº”ï¼š å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯å“åº”æ•°æ® æ— çŠ¶æ€çš„ï¼š åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼Œå®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥å‘é€è¯·æ±‚æ—¶éœ€è¦è¿›è¡Œä¸€ç³»åˆ—çš„å®‰å…¨è®¤è¯åŒ¹é…ç­‰ï¼Œå› æ­¤å¢åŠ é¡µé¢ç­‰å¾…æ—¶é—´ï¼Œå½“å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯å“åº”å®Œæ¯•åï¼Œä¸¤è€…æ–­å¼€è¿æ¥ï¼Œä¹Ÿä¸ä¿å­˜è¿æ¥çŠ¶æ€ï¼Œä¸€åˆ€ä¸¤æ–­ï¼æ©æ–­ä¹‰ç»ï¼ä»æ­¤è·¯äººï¼ä¸‹ä¸€æ¬¡å®¢æˆ·ç«¯å‘åŒæ ·çš„æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œç”±äºä»–ä»¬ä¹‹å‰å·²ç»é—å¿˜äº†å½¼æ­¤ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°å»ºç«‹è¿æ¥ã€‚ åº”ç”¨å±‚ï¼š Httpæ˜¯å±äºåº”ç”¨å±‚çš„åè®®ï¼Œé…åˆTCP/IPä½¿ç”¨ã€‚ TCP/IPï¼š Httpä½¿ç”¨TCPä½œä¸ºå®ƒçš„æ”¯æ’‘è¿è¾“åè®®ã€‚HTTPå®¢æˆ·æœºå‘èµ·ä¸€ä¸ªä¸æœåŠ¡å™¨çš„TCPè¿æ¥ï¼Œä¸€æ—¦è¿æ¥å»ºç«‹ï¼Œæµè§ˆå™¨ï¼ˆå®¢æˆ·æœºï¼‰å’ŒæœåŠ¡å™¨è¿›ç¨‹å°±å¯ä»¥é€šè¿‡å¥—æ¥å­—æ¥å£è®¿é—®TCPã€‚ é’ˆå¯¹æ— çŠ¶æ€çš„ä¸€äº›è§£å†³ç­–ç•¥ï¼š æœ‰æ—¶éœ€è¦å¯¹ç”¨æˆ·ä¹‹å‰çš„HTTPé€šä¿¡çŠ¶æ€è¿›è¡Œä¿å­˜ï¼Œæ¯”å¦‚æ‰§è¡Œä¸€æ¬¡ç™»é™†æ“ä½œï¼Œåœ¨30åˆ†é’Ÿå†…æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¸éœ€è¦å†æ¬¡ç™»é™†ã€‚äºæ˜¯å¼•å…¥äº†CookieæŠ€æœ¯ã€‚ HTTP/1.1æƒ³å‡ºäº†æŒä¹…è¿æ¥ï¼ˆHTTP keep-aliveï¼‰æ–¹æ³•ã€‚å…¶ç‰¹ç‚¹æ˜¯ï¼Œåªè¦ä»»æ„ä¸€ç«¯æ²¡æœ‰æ˜ç¡®æå‡ºæ–­å¼€è¿æ¥ï¼Œåˆ™ä¿æŒTCPè¿æ¥çŠ¶æ€ï¼Œåœ¨è¯·æ±‚é¦–éƒ¨å­—æ®µä¸­çš„Connection: keep-aliveå³ä¸ºè¡¨æ˜ä½¿ç”¨äº†æŒä¹…è¿æ¥ã€‚ç­‰ç­‰è¿˜æœ‰å¾ˆå¤šã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ ä¸‹é¢å¼€å§‹è®²è§£é‡å¤´æˆï¼šHTTPè¯·æ±‚æŠ¥æ–‡ï¼Œå“åº”æŠ¥æ–‡ï¼Œå¯¹åº”äºä¸Šè¿°æ­¥éª¤çš„2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ã€‚ HTTPæŠ¥æ–‡æ˜¯é¢å‘æ–‡æœ¬çš„ï¼ŒæŠ¥æ–‡ä¸­çš„æ¯ä¸€ä¸ªå­—æ®µéƒ½æ˜¯ä¸€äº›ASCIIç ä¸²ï¼Œå„ä¸ªå­—æ®µçš„é•¿åº¦æ˜¯ä¸ç¡®å®šçš„ã€‚HTTPæœ‰ä¸¤ç±»æŠ¥æ–‡ï¼šè¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡ã€‚ HTTPè¯·æ±‚æŠ¥æ–‡ä¸€ä¸ªHTTPè¯·æ±‚æŠ¥æ–‡ç”±è¯·æ±‚è¡Œï¼ˆrequest lineï¼‰ã€è¯·æ±‚å¤´éƒ¨ï¼ˆheaderï¼‰ã€ç©ºè¡Œå’Œè¯·æ±‚æ•°æ®4ä¸ªéƒ¨åˆ†ç»„æˆï¼Œä¸‹å›¾ç»™å‡ºäº†è¯·æ±‚æŠ¥æ–‡çš„ä¸€èˆ¬æ ¼å¼ã€‚ è¯·æ±‚è¡Œåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šè¯·æ±‚æ–¹æ³•ã€è¯·æ±‚åœ°å€å’Œåè®®ç‰ˆæœ¬ 1. è¯·æ±‚æ–¹æ³• HTTP/1.1 å®šä¹‰çš„è¯·æ±‚æ–¹æ³•æœ‰8ç§ï¼šGETã€POSTã€PUTã€DELETEã€PATCHã€HEADã€OPTIONSã€TRACE 2.è¯·æ±‚å¤´éƒ¨ è¯·æ±‚å¤´éƒ¨ä¸ºè¯·æ±‚æŠ¥æ–‡æ·»åŠ äº†ä¸€äº›é™„åŠ ä¿¡æ¯ï¼Œç”±â€œå/å€¼â€å¯¹ç»„æˆï¼Œæ¯è¡Œä¸€å¯¹ï¼Œåå’Œå€¼ä¹‹é—´ä½¿ç”¨å†’å·åˆ†éš”ã€‚ ä¸‹é¢æ˜¯http responseåŒ…çš„ä¸€äº›ç»“æ„å…·ä½“çš„å¯ä»¥å‚ç…§ä¸‹é¢çš„å®ä¾‹ http responseçš„ç»“æ„å®ä¾‹ 1234567891011121314151617181920212223242526272829303132333435363738394041HTTP/1.1 200 OK çŠ¶æ€è¡ŒDate: Sun, 17 Mar 2017 08:12:54 GMT å“åº”å¤´éƒ¨Server: Apache/2.2.8 (Win32) PHP/5.2.5X-Powered-By: PHP/5.2.5Set-Cookie: PHPSESSID=c0huq7pdkmm5gg6osoe3mgjmm3; path=/Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0,pre-check=0Pragma: no-cacheContent-Length: 4393Keep-Alive: timeout=5, max=100Connection: Keep-AliveContent-Type: text/html; charset=utf-8ç©ºè¡Œ å“åº”æ•°æ®HTTPå“åº”ç¤ºä¾‹Hello HTTP! ä¸‹é¢æ˜¯pythonè„šæœ¬ï¼Œåˆ©ç”¨scapyæ¨¡å—åº“ï¼Œç”Ÿæˆæ•°æ®åŒ…ï¼Œå»ºç«‹tcpä¸‰æ¬¡æ¡æ‰‹ï¼Œä¼ è¾“httpæŠ¥æ–‡çš„ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243#! /usr/bin/env python# Change log level to suppress annoying IPv6 errorimport logginglogging.getLogger(\"scapy.runtime\").setLevel(logging.ERROR)# Import scapyfrom scapy.all import *# Print info headerprint \"[*] ACK-GET example -- Thijs 'Thice' Bosschert, 06-06-2011\"# Prepare GET statementget = 'GET / HTTP/1.1\\r\\nHost:49.234.82.163\\r\\nUser-Agent:python/2.7\\r\\nAccept:*/*\\r\\n\\r\\n'# Set up target IPip=IP(dst=\"49.234.82.163\")# Generate random source port numberport=RandNum(1024,65535)# Create SYN packetSYN=ip/TCP(sport=port, dport=80, flags=\"S\", seq=42)# Send SYN and receive SYN,ACKprint \"\\n[*] Sending SYN packet\"SYNACK=sr1(SYN)# Create ACK with GET requestACK=ip/TCP(sport=SYNACK.dport, dport=80, flags=\"A\", seq=SYNACK.ack,ack=SYNACK.seq + 1) # SEND our ACK-GET requestprint \"\\n[*] Sending ACK-GET packet\"send(ACK)reply,error=sr(ip/TCP(sport=SYNACK.dport, dport=80, flags=\"PA\", seq=SYNACK.ack,ack=SYNACK.seq + 1)/get)# print reply from serverprint \"\\n[*] Reply from server:\"print reply.show()print reply[0]print '\\n[*] Done!' å¯ä»¥ç”¨æŠ“åŒ…çš„wiresharkå‘ç°æœåŠ¡å™¨ç«¯æœ‰å›å¤okï¼Œä¹Ÿå¯ä»¥ç”¨sniffï¼ˆï¼‰æ¥å—…æ¢ï¼Œ 12345å…¶ä¸­ifaceå› ç”µè„‘è€Œå¼‚çš„ï¼Œç„¶åå¯ä»¥çœ‹åˆ°å¦‚ä¸‹æ‰€ç¤ºï¼Œå…·ä½“çš„æ˜¯å“ªä¸€ä¸ªç´¢å¼•ä¹Ÿè·Ÿç›®å‰ç”µè„‘è¿è¡Œçš„çŠ¶æ€æœ‰å…³ï¼Œå¯ä»¥å¤šè¾“å‡ºå‡ ä¸ªè¯•è¯•ä½†æ˜¯æ¡æ‰‹è¿‡ç¨‹å¯èƒ½ä¼šå› ä¸ºtcpçš„RSTè€Œå¯¼è‡´æ¡æ‰‹å¤±è´¥ï¼Œåªä¸»è¦æ˜¯linuxå†…æ ¸æ”¶åˆ°ackæ—¶ï¼Œè®¤ä¸ºè‡ªå·±å¹¶æ²¡æœ‰å‘å‡ºSYNï¼Œæ‰€ä»¥å‘å‡ºRSTï¼Œé‡ç½®è¿æ¥ï¼Œéœ€è¦é…ç½®iptableè¿‡æ»¤æ‰RSTçš„åŒ…ï¼Œä¸‹é¢çš„IPä¸ºclinetç«¯çš„ip```iptables -A OUTPUT -p tcp --tcp-flags RST RST -s 192.168.1.20 -j DROP 2. http/url & p4å­˜åœ¨çš„é—®é¢˜ httpé¢å‘è¿æ¥çš„ï¼Œæ˜¯éœ€è¦å ç”¨ç«¯å£çš„ï¼Œå¦‚æœå®ç°çš„è¯ï¼Œéœ€è¦å®ç°tcpå±‚çš„åŠŸèƒ½ httpçš„requestå’Œresponseä¸æ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œè€Œä¸”ä»–ä»¬çš„å¯¹åº”åºåˆ—ä¹Ÿå¯ä»¥æŒ‰ç…§ç½‘ç»œä¸åŒè€Œä¸åŒï¼Œè¿™ç”±ä¼ è¾“å±‚æ¥å¸®å¿™å®Œæˆï¼Œéœ€è¦æ‰¾åˆ°å¯¹åº”å…³ç³»ï¼Ÿï¼Ÿï¼Ÿä»æŠ“åŒ…çš„ç»“æœæ¥çœ‹ï¼šä¸€å¯¹ä¼šè¯çš„ackã€seqå’Œtcp lengthæœ‰å…³çš„å³ack = seq + tcp_lengthï¼›å…¶ä¸­seqå°±ç­‰äºä¸Šä¸€æ¬¡å‘è¿‡æ¥çš„ackæˆ–è€…éšæœºä¹Ÿå¯ä»¥ httpçš„responseå¯ä»¥æ˜¯å•ä¸ªæ•°æ®åŒ…ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªï¼Œå¯ä»¥è€ƒè™‘å•ä¸ªçš„å°çš„å“åº”åŒ…","link":"/2019/10/24/HTTP_Comprehensive/"},{"title":"P4-Controller","text":"åˆ©ç”¨P4 Runtimeéœ€è¦æ§åˆ¶å™¨æ¥è¿æ¥æ¯ä¸ªè½¬å‘å™¨ï¼Œæœ¬æ–‡å°±æ˜¯è®°å½•å¦‚ä½•é€šè¿‡CLIå’Œpythonæ–‡æœ¬è¿æ¥switch å½“ç½‘ç»œç»“æ„ä¸­å«æœ‰å¤šä¸ªäº¤æ¢è®¾å¤‡æ—¶ï¼Œåˆ©ç”¨ä¸€ä¸ªè¿œç¨‹ä¸»æœºå¼€å¯ä¸åŒçš„è¿›ç¨‹è¿è¡ŒCLIå¯ä»¥åˆ†åˆ«è¿æ¥å¤šä¸ªäº¤æ¢è®¾å¤‡ 123456789# å¼€å¯ä¸€ä¸ªterminalsimple_switch_CLI --thrift-port 9090# é»˜è®¤ç›‘è§†ç«¯å£æ˜¯9090ï¼Œè¿æ¥çš„æ˜¯ç¬¬ä¸€ä¸ªå®ä¾‹çš„switch# å†å¼€å¯ä¸€ä¸ªterminalsimple_switch_CLI --thrift-port 9091# é»˜è®¤ç›‘è§†ç«¯å£æ˜¯9090ï¼Œé€’å¢ä¸€ä¸ªç«¯å£å·ï¼Œè¿æ¥çš„æ˜¯ç¬¬äºŒä¸ªå®ä¾‹çš„switch# å†å¼€å¯ä¸€ä¸ªterminalsimple_switch_CLI --thrift-port 9092# é»˜è®¤ç›‘è§†ç«¯å£æ˜¯9090ï¼Œé€’å¢2ä¸ªç«¯å£å·ï¼Œè¿æ¥çš„æ˜¯ç¬¬3ä¸ªå®ä¾‹çš„switch å½“ç½‘ç»œç»“æ„ä¸­å«æœ‰å¤šä¸ªäº¤æ¢è®¾å¤‡æ—¶ï¼Œåˆ©ç”¨ä¸€ä¸ªè¿œç¨‹ä¸»æœºå¼€å¯ä¸åŒçš„è¿›ç¨‹è¿è¡Œpythonè„šæœ¬åŒæ ·å¯ä»¥åˆ†åˆ«è¿æ¥å¤šä¸ªäº¤æ¢è®¾å¤‡ 12345678910# å¼€å¯ä¸€ä¸ªterminalcd /home/vagrant/behavioral-model/tools./runtime_CLI.py --thrift-port 9090# é»˜è®¤ç›‘è§†ç«¯å£æ˜¯9090ï¼Œè¿æ¥çš„æ˜¯ç¬¬ä¸€ä¸ªå®ä¾‹çš„switch# å†å¼€å¯ä¸€ä¸ªterminal./runtime_CLI.py --thrift-port 9091# é»˜è®¤ç›‘è§†ç«¯å£æ˜¯9090ï¼Œé€’å¢ä¸€ä¸ªç«¯å£å·ï¼Œè¿æ¥çš„æ˜¯ç¬¬äºŒä¸ªå®ä¾‹çš„switch# å†å¼€å¯ä¸€ä¸ªterminal./runtime_CLI.py --thrift-port 9092# é»˜è®¤ç›‘è§†ç«¯å£æ˜¯9090ï¼Œé€’å¢2ä¸ªç«¯å£å·ï¼Œè¿æ¥çš„æ˜¯ç¬¬3ä¸ªå®ä¾‹çš„switch","link":"/2019/11/20/P4-Controller/"},{"title":"P4 Runtime åˆæ­¥ä½¿ç”¨","text":"P4Runtimeæ˜¯P4çš„ä¸€ä¸ªæ§åˆ¶é¢çš„åè®®ï¼Œä¹Ÿå«å—å‘åè®®ï¼Œç”¨äºä¸‹å‘æµè¡¨ã€è§„åˆ™ç­‰ä½œç”¨ï¼Œä½†æ˜¯P4ä¸€èˆ¬æä¾›äº†PCIè¿™ä¸€ä¸ªæ¨¡å—æ¥ä¿®æ”¹æµè¡¨ç­‰é™æ€å­˜å‚¨ï¼Œè¿™äº›æ¨¡å—å¯¹äºéœ€æ±‚å¾€å¾€ä¸å¤Ÿï¼Œæ‰€ä»¥æœ¬æ–‡è®°å½•ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨P4Runtimeæ¥ä»æ§åˆ¶é¢è¯»ã€å†™ã€æ”¹ä¸€äº›é™æ€çš„æµè¡¨ã€registerã€counterç­‰ã€‚ é¦–å…ˆcdåˆ°/behavioral-model/toolsæ–‡ä»¶ä¸‹é¢ï¼Œçœ‹åˆ°ç›®å½•ä¸‹æœ‰ä¸€ä¸ªruntime_CLI.py,è¿™ä¸ªæ–‡ä»¶å°±æ˜¯æˆ‘ä»¬ç”¨æ¥ä¿®æ”¹çš„æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶æœ¬æ¥çš„åŠŸèƒ½å°±æ˜¯CLIçš„å‘½ä»¤å¾ªç¯ï¼Œæˆ‘ä»¬å¯ä»¥ç«‹è¶³äºå®ƒåšä¸€äº›è‡ªå®šä¹‰çš„åŠ¨ä½œï¼Œè€Œä¸éœ€è¦åœ¨CLIçš„å‘½ä»¤è¡Œè¾“å…¥ï¼Œåªéœ€è¦è¿è¡Œä¸€ä¸ªpythonè„šæœ¬å°±å¯ä»¥äº†ã€‚ runtime_CLI.pyé‡Œé¢æŠŠæ‰€æœ‰çš„APIéƒ½å†™åœ¨äº†class RuntimeAPIé‡Œé¢äº†ã€‚è€Œåœ¨ä¸»ç¨‹åºé‡Œé¢åªå†™äº†ä¸€å¥ 1RuntimeAPI(args.pre, standard_client, mc_client).cmdloop() æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨class RuntimeAPIä¸­è‡ªå·±å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°ä¸­è°ƒç”¨ä¸åŒçš„åŠ¨ä½œç»„åˆï¼Œç„¶ååœ¨ä¸»ç¨‹åºé‡Œè°ƒç”¨è¿™ä¸ªæˆå‘˜å‡½æ•°å°±å¯ä»¥å®ç°è¿è¡Œè‡ªå·±è§„å®šçš„é‚£äº›åŠ¨ä½œäº†ï¼Œè€Œè¿™äº›åŠ¨ä½œæ€ä¹ˆç»„åˆæ ¹æ®ä¸ªäººçš„éœ€è¦å³å¯ã€‚","link":"/2019/11/20/P4Runtimeåˆæ­¥ä½¿ç”¨/"},{"title":"P4_lang","text":"p4è¯­è¨€ç®€ä»‹P4(Programming Protocol-Independent Packet Processors) æ˜¯ä¸€ç§æ•°æ®é¢çš„é«˜çº§ç¼–ç¨‹è¯­è¨€ã€‚æ•°æ®é¢ç¼–ç¨‹å°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰åŒ¹é…å­—æ®µ ï¼Œè‡ªå®šä¹‰åŠ¨ä½œç±»å‹ ï¼Œ ä»è€Œè‡ªå®šä¹‰æµè¡¨ ï¼Œè¿›è€Œå½¢æˆæµæ°´çº¿ã€‚p4ä¸ä»…å¯ä»¥å¯¹æ•°æ®æµè¿›è¡Œè½¬å‘ï¼Œè¿˜å¯ä»¥å¯¹äº¤æ¢æœºç­‰è½¬å‘è®¾å¤‡çš„æ•°æ®å¤„ç†æµç¨‹è¿›è¡Œè½¯ä»¶ç¼–ç¨‹å®šä¹‰ã€‚p4è¯­è¨€å®ç°çš„äº¤æ¢æœºæ¶æ„å¦‚ä¸‹å›¾ p4è¯­è¨€ç‰¹ç‚¹p4çš„å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ï¼š å¯ä»¥å®ç°ç°æœ‰åè®®çš„è½¬å‘åŠŸèƒ½ å¯ä»¥è‡ªå®šä¹‰æ•°æ®åŒ…ç»“æ„ å¯ä»¥åœ¨ç°æœ‰åè®®çš„åŸºç¡€ä¸Šè¿›è¡Œæ–°çš„åŠŸèƒ½å¼€å‘ SW é£æ ¼å¼€å‘â€”â€”åè®®å’Œè½¬å‘çš„å¼€å‘æ¨¡å¼ç±»ä¼¼äºè½¯ä»¶å¼€å‘ p4çš„è¯­è¨€è¦ç´  headersï¼ˆmetadataï¼‰ parser table & action control flow codeheaderså¯ä»¥è‡ªå®šä¹‰headerï¼Œæ·»åŠ ç›®å‰æ•°æ®åŒ…ä¸­ä¸å­˜åœ¨çš„å­—æ®µï¼Œä¾¿äºå®ç°è½¬å‘æ—¶å€™ç‰¹å®šå­—æ®µçš„åŒ¹é…å’ŒåŠ¨ä½œã€‚ä½†æ˜¯p4å†™æˆçš„ç¨‹åºåªè´Ÿè´£è§£æå­—æ®µï¼Œæ‰€ä»¥è¿˜éœ€è¦è½¯ä»¶ç¯å¢ƒã€‚parserç”¨äºè§£ææ•°æ®åŒ…çš„headersçš„çŠ¶æ€æœºï¼Œä»–å¯ä»¥æœ‰å¾ˆå¤šç§çŠ¶æ€ï¼Œå¯ä»¥æ ¹æ®æ¥çš„æ•°æ®åŒ…çš„çŠ¶æ€æ¥é€‰æ‹©å˜æˆå“ªä¸ªçŠ¶æ€ï¼Œè€Œä¸”æœ‰ä¸‰ä¸ªé¢„ç•™çš„çŠ¶æ€ start reject accepté™¤è¿™ä¸‰ä¸ªä¹‹å¤–çš„çŠ¶æ€å¯ä»¥è‡ªå·±å®šä¹‰ï¼ŒçŠ¶æ€ä¹‹é—´çš„è½¬å˜ä¹Ÿå¯ä»¥ç”¨æˆ·è‡ªå·±å®šä¹‰ï¼Œå®Œå…¨æ˜¯å¯ç¼–ç¨‹çš„ã€‚table & actiontableæ˜¯ç”±controlleré€šè¿‡å—å‘åè®®è¿›è¡Œä¸‹å‘ï¼Œè€ŒåŒ¹é…çš„æ¨¡å¼å¯ä»¥ç”±p4è¯­è¨€æ¥ç¡®å®šï¼Œtableåªæä¾›äº†è¡¨ï¼Œæ€ä¹ˆå»æŸ¥è¡¨ï¼ŒæŸ¥è¡¨ä¹‹åè¿›è¡Œæ€ä¹ˆæ ·çš„åŠ¨ä½œï¼Œä¹Ÿéƒ½å®Œå…¨ç”±p4ç¨‹åºæ¥ç¡®å®šï¼ŒåŒ…æ‹¬åŒ¹é…çš„keyï¼Œä¸‹ä¸€æ­¥çš„action idï¼Œä½†æ˜¯action dataæ˜¯ç”±tableä¼ å‡ºæ¥çš„ã€‚control flow codeè¿™éƒ¨åˆ†å°±åƒæ˜¯c++ç¨‹åºé‡Œé¢çš„é¡ºåºç»“æ„ï¼Œè§„å®šå…ˆå¹²ä»€ä¹ˆï¼Œç„¶ååœ¨å¹²ä»€ä¹ˆï¼Œæœ€åå¹²ä»€ä¹ˆï¼Œè¿™éƒ¨åˆ†çš„å¯ç¼–ç¨‹åŒ–ï¼ŒæŠŠäº¤æ¢æœºçš„å•ä¸€åŠŸèƒ½å˜å¾—æ›´åŠ è‡ªä¸»å’Œæ™ºèƒ½åŒ–ã€‚äº¤æ¢æœºä¸å†ä»…ä»…å®Œæˆç®€å•çš„ipæˆ–è€…åç§°åŒ¹é…ï¼Œè€Œæ˜¯åˆä¸€ä¸ªå¤æ‚çš„æµç¨‹éœ€è¦å®Œæˆï¼Œå¯ä»¥æ˜¯å¤šä¸ªåŒ¹é…ä»»åŠ¡çš„è¿ç»­ï¼Œä¹Ÿå¯ä»¥å¯¹æ•°æ®åŒ…çš„åŒ…å¤´è¿›è¡Œä¿®æ”¹ï¼Œå¢åŠ ï¼Œåˆ å‡ç­‰åŠ¨ä½œã€‚æ‰€è°“çš„åè®®å’Œè½¬å‘ç­–ç•¥ä¸€åˆ‡å˜å¾—è·Ÿè½¯ä»¶å¼€å‘ä¸€æ ·ç®€å•ã€‚","link":"/2019/10/24/P4_data_plane_lang/"},{"title":"P4_tutorials","text":"ğŸ˜ç»è¿‡æ¥è¿ä¸¤å‘¨è¿ç»­æ¯å¤©ç†Ÿæ‚‰p4å®˜æ–¹ç»™å‡ºçš„æ•™ç¨‹ï¼Œæ…¢æ…¢çš„å¯¹p4æœ‰äº†è¿›ä¸€æ­¥çš„ç†è§£ã€‚ğŸ‘p4æ˜¯ä¸€ä¸ªæ•°æ®é¢çš„ç¼–ç¨‹è¯­è¨€ï¼Œèƒ½å¤Ÿå¯¹æ•°æ®åŒ…çš„åŒ…å¤´è‡ªå®šä¹‰è®¾è®¡ã€è‡ªå®šä¹‰è§£æï¼Œç„¶åè®¾è®¡æµç¨‹è®©æ•°æ®åŒ…æŒ‰ç…§åŒ…å¤´çš„è§£æç»“æœè¿›è¡Œæµè¡¨çš„åŒ¹é…å’ŒåŠ¨ä½œçš„æ‰§è¡Œï¼ŒåŠ¨ä½œåŒ…æ‹¬ï¼šğŸ‘‰å¯¹æ•°æ®åŒ…è½¬å‘ç»™ä¸‹ä¸€ä¸ªç«¯å£ï¼Œcloneæ•°æ®åŒ…ï¼Œä¿®æ”¹æ•°æ®åŒ…çš„åŒ…å¤´ã€æ·»åŠ æˆ–è€…å‡å°‘æ•°æ®åŒ…çš„åŒ…å¤´ã€ç»™æ§åˆ¶å±‚è½¬å‘æ•°æ®åŒ…ç­‰ç­‰åŠ¨ä½œã€‚ p4è¯­è¨€çš„æ‰§è¡Œæµç¨‹ å®˜æ–¹çš„æ•™ç¨‹demoä¸­ä»…ç»™å‡ºçš„æ˜¯v1modelçš„targetè½¬å‘æ¨¡å‹ï¼ŒP4_16å’ŒP4_14éƒ½æ”¯æŒè¿™ç§è½¬å‘æ¨¡å‹ï¼Œæ‰€ä»¥æˆ‘çš„å®éªŒå’Œç†è§£éƒ½æ˜¯åŸºäºè¿™ç§è½¬å‘æ¨¡å‹çš„ã€‚v1modelæ¨¡å‹å›¾å’Œp4ç¨‹åºçš„é¡ºåºç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ‰€ä»¥å‘¢æ‰§è¡Œçš„é¡ºåºå¯ä»¥æ¸…æ¥šçš„çœ‹å‡ºæ¥ã€‚ parseçŠ¶æ€æœºçš„ç†è§£ ä½†æ˜¯é’ˆå¯¹parseè¿™ä¸€ç¯èŠ‚ï¼Œæˆ‘ä¸€åº¦å¾ˆå›°æ‰°ï¼Œå› ä¸ºæˆ‘ä¸€ç›´æƒ³è§£æä¸€ä¸ªä¸å®šé•¿çš„headerï¼Œä½†æ˜¯ä¸€ç›´æ‰¾ä¸åˆ°æ¡ˆä¾‹ï¼Œè€Œä¸”åœ¨p4_16çš„è¯­è¨€è§„èŒƒçš„æ–‡æ¡£ä¸­ï¼Œæä¾›äº†ä¸€ç§å˜é•¿çš„headerç»“æ„ï¼Œä½†æ˜¯å‰ææ˜¯ä½ å¾—äº‹å‰çŸ¥é“æœ‰å¤šé•¿ï¼Œç±»ä¼¼äºipv4çš„lengthå­—æ®µï¼Œå°½ç®¡ipv4æœ‰optionå­—æ®µï¼Œä½†æ˜¯lengthå­—æ®µåˆæ˜ç¡®äº†é•¿åº¦ï¼Œæ‰€ä»¥p4çš„å˜é•¿headerä¹Ÿæ˜¯è¿™ç§æœºåˆ¶ã€‚ä½†æ˜¯è¿™å¯¹æˆ‘äºp4çš„headerè§£æï¼Œæœ‰äº†ä¸€ä¸ªè®¤è¯†çš„å¥‘æœºï¼Œæœ¬æ¥æˆ‘ä¸€ç›´ä»¥ä¸ºè¿™ä¸ªè§£æå’Œç»“æ„ä¹‹é—´çš„å£°æ˜é¡ºåºæœ‰å¾ˆå¤§çš„å…³ç³»ï¼Œç»“æœï¼ŒğŸ˜€å‘ç°è¿™ä¸ªå’Œåä¸ºæå‡ºçš„pofæ¶æ„å¾ˆç±»ä¼¼éƒ½æ˜¯åˆ©ç”¨åç§»æ¥åšçš„è§£æï¼Œåªä¸è¿‡p4è¯­è¨€æ›´åŠ é«˜çº§ï¼Œä½ ä¸èƒ½ä»ä»£ç ä¸Šçœ‹å‡ºåç§»ï¼Œä½†æ˜¯æœ¬è´¨è¿˜æ˜¯åç§»ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªæ•°æ®åŒ…ï¼Œï¼ˆè¿™æ˜¯ç”¨scapyå‘å‡ºçš„æ•°æ®åŒ…ğŸï¼‰ã€‚ 1sendp(Ether()/IP()/TCP()/\"Hello\") é‚£ä¹ˆå½“switchæ”¶åˆ°packetæ—¶ï¼ŒğŸ‘‰è¿›å…¥åˆ°start stateçŠ¶æ€ï¼Œé‚£ä¹ˆå¯ä»¥çœ‹å‡ºæ¥è¿™ä¸ªåŒ…æ˜¯ç¬¬äºŒå±‚çš„åŒ…ï¼Œé‚£ä¹ˆåŠ¿å¿…è¦é¦–å…ˆè§£æçš„æ˜¯æœ€å¤–å±‚çš„Etherå±‚ï¼Œä»–æ˜¯ä»ç¬¬0ä½å¼€å§‹è§£æåˆ°Ether headerçš„sizeä¸ºæ­¢ï¼ŒğŸ‘‰é‚£ä¹ˆä¸‹ä¸€æ­¥çš„çŠ¶æ€å°±è½¬ç§»åˆ°parse_ether stateçŠ¶æ€ï¼Œå¹¶ä¸”å¼€å§‹è§£æipv4çš„headerï¼ŒåŒç†ä»–æ˜¯ä»Etherç»“æŸçš„ä¸‹ä¸€ä½ä¸€ç›´è§£æipv4çš„sizeé•¿åº¦ä½ç½®ä¸ºæ­¢ï¼ŒğŸ‘‰ä¾æ¬¡ä¸‹å»ï¼Œæ‰€ä»¥æ¯æ¬¡ä½ é€‰æ‹©çš„stateçš„è§£æåŠ¨ä½œä¸€å®šæ˜¯æš´éœ²åœ¨æœ€å¤–å±‚çš„ï¼Œä½ ä¸èƒ½ä¸€ä¸Šæ¥å°±ç›´æ¥è§£ætcpï¼Œå› ä¸ºä»–ä¼šä»¥ä¸ºæ˜¯ä»0å¼€å§‹è§£ætcp headeré•¿åº¦ä¸ªbitä½ï¼Œè¿™æ˜¯é”™è¯¯çš„ï¼ŒğŸ‘æ‰€ä»¥å“ªæ€•ä½ å¯¹äºè¿™ä¸ªheaderä¸æ„Ÿå…´è¶£ï¼Œä½ ä¹Ÿå¾—ä¸€å±‚ä¸€å±‚çš„è§£æheaderã€‚è§£æå®Œä¹‹åï¼Œæ‰€æœ‰è§£æè¿‡çš„headeréƒ½æ˜¯å¯ä»¥åœ¨åé¢çš„æ­¥éª¤ä¸­ç›´æ¥ä½¿ç”¨ï¼ŒåŒ…æ‹¬èµ‹å€¼ï¼Œå’Œå¼•ç”¨ã€‚ table-match tableçš„matchåŠ¨ä½œå¯ä»¥åªåŒ…å«åŠ¨ä½œï¼Œä¸å«æœ‰keyé‚£æ ·çš„è¯å°±ç›¸å½“äºç›´æ¥æ‰§è¡Œé»˜è®¤çš„actionï¼Œè¿˜æœ‰ä¸€ä¸ªå°±æ˜¯åœ¨applyçš„æµç¨‹ä¸­ä¸èƒ½ç›´æ¥æ“ä½œactionæ‰€ä»¥å¯ä»¥åˆ©ç”¨ä¸Šé¢çš„è¿™ç§æœºåˆ¶æ¥ç›´æ¥æ‰§è¡ŒæŸé¡¹actionã€‚tableåŒæ ·å¯ä»¥é€šè¿‡CLIæ¥ä¸‹å‘ï¼Œåœ¨mininet CLIä¸­è¾“å…¥xterm s1ï¼Œæ˜¾ç¤ºå‡ºs1çš„terminalï¼Œè¿™è¡¨æ˜è¿™æ˜¯s1äº¤æ¢æœºçš„terminalï¼Œç„¶åè¿è¡Œsimple_switch_CLI --thrift-port 9090 --json basic.jsonå°±å¯ä»¥è¿›å…¥åˆ°s1äº¤æ¢æœºçš„CLIäº¤äº’ç•Œé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä½ å¯ä»¥é€šè¿‡è¾“å…¥helpæ˜¾ç¤ºå­˜åœ¨çš„å‘½ä»¤ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡help+æŸä¸€ä¸ªå‘½ä»¤æ¥æ˜¾ç¤ºè¿™ä¸ªå‘½ä»¤æ€ä¹ˆç”¨ğŸ‘ã€‚å…·ä½“çš„å„ç§æ“ä½œå¯ä»¥å‚ç…§github p4langçš„ä»“åº“ã€‚ è¿™é‡Œå¦å¤–éœ€è¦è®²çš„å°±æ˜¯cloneæ•°æ®åŒ…ï¼Œåœ¨p4_14çš„tutorialä¸­è¿˜å­˜åœ¨ä¸€ä¸ªcopy_to_cpuçš„æ¡ˆä¾‹ï¼Œä½†æ˜¯åœ¨p4_16ä¸­å´ä¸åœ¨äº†ğŸ˜­ï¼Œæ‰€ä»¥æˆ‘æ‰¾äº†å¾ˆå¤šçš„èµ„æ–™æ‰å¼„æ¸…æ¥šå‡½æ•°çš„æ¼”å˜å…³ç³»ï¼Œç°åœ¨ç›´æ¥è°ƒç”¨clone3å‡½æ•°å°±å¯ä»¥å•¦ï¼Œç›´æ¥å®ç°clone packetçš„åŠŸèƒ½ï¼Œå…·ä½“çš„å‡½æ•°è¯´æ˜å¯ä»¥å‚ç…§ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ç»™å‡ºä¸€ä¸ªæˆ‘å®ç°çš„æµç¨‹ clone packet with p4ğŸ¤œ1. åœ¨p4_16çš„tutorialçš„basicæ¡ˆä¾‹ä¸­çš„basic.p4æ–‡ä»¶ä¸­åŠ å…¥clone3(CloneType.I2E,250,standard_metadata);ï¼Œåªæ˜¯è¦åŠ åœ¨ingressä¸­çš„ï¼Œè¿™ä¸ªä¸ç¬¬ä¸€ä¸ªå‚æ•°ç›¸å¯¹åº”ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¡¨æ˜æ˜¯ingress->egressï¼Œæ‰€ä»¥è¦ä¸ä¹‹å¯¹åº”ï¼ŒğŸ¤œ2. ç¬¬äºŒä¸ªå‚æ•°æ˜¯mirror_idï¼Œè¿™ä¸ªåé¢éœ€è¦åœ¨CLIä¸­ä¸‹å‘ï¼Œç±»ä¼¼äºä¸€ä¸ªæµè¡¨çš„å˜é‡ï¼Œä¸‹å‘mirroræ—¶éœ€è¦ç”¨åˆ°ä¸‹é¢çš„å‘½ä»¤mirroring_add 250 3,è¿™è¡¨æ˜ç¬¬äºŒä¸ªå‚æ•°æ˜¯250æ—¶éœ€è¦ä»2ç«¯å£è½¬å‡ºå»ï¼Œè¿™ä¸ªä¸åŸæ¥çš„packetæ˜¯ä¸ç›¸å¹²çš„ï¼Œæœ€åä¸€ä¸ªæˆ‘æš‚æ—¶è¿˜ä¸æ˜¯å¾ˆæ˜ç¡®èƒ½å¹²ä»€ä¹ˆï¼Œå› ä¸ºä¹Ÿæœ‰ä¸€ä¸ªå‡½æ•°cloneè¿™å°±ç›¸å½“äºæ²¡æœ‰ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚ä½†æ˜¯cloned packetä¸åŸæœ¬çš„packetä¹‹é—´çš„åŒºåˆ«ç”±standard_metadata.instance_typeå¯ä»¥åŒºåˆ†ï¼Œæ‰€ä»¥åœ¨egressä¸­å¯ä»¥é€šè¿‡åŒ¹é…standard_metadata.instance_typeæ¥å®ç°ä¿®æ”¹ç›®çš„åœ°å€çš„åŠ¨ä½œï¼Œéœ€è¦åœ¨æ§åˆ¶é¢è¾“å…¥table_add direct change_ipv4 1 =>æ¥é…ç½®æµè¡¨ï¼Œä½¿å¾—å½“åŒ¹é…çš„keyï¼šstandard_metadata.instance_typeä¸º1æ—¶ï¼Œé‡‡å–change_ipv4çš„action.ğŸ‘Œè¿™æ ·å°±å¯ä»¥å®ç°cloneæ•°æ®åŒ…äº†ï¼Œå®ç°çš„ç»“æœå°±æ˜¯å½“ä½ ä»h1å‘å‡ºä¸€ä¸ªæ•°æ®åŒ…æ—¶ï¼Œèƒ½åœ¨h2æ”¶åˆ°ä¸¤ä¸ªã€‚","link":"/2019/10/24/P4_tutorials/"},{"title":"P4app-docker","text":"ä»‹ç»p4appp4appæ˜¯ä¸€ä¸ªå¯ä»¥æ„å»ºã€è¿è¡Œã€è°ƒè¯•å’Œæµ‹è¯•P4ç¨‹åºçš„å·¥å…·ï¼Œp4appèƒŒåè•´å«çš„å“²å­¦æ˜¯â€œç®€å•çš„äº‹æƒ…åº”å°½å¯èƒ½ç®€å•â€ï¼Œæ—¨åœ¨ä½¿å°è€Œç®€å•çš„P4ç¨‹åºæ˜“äºç¼–å†™ã€æ˜“äºä¸ä»–äººåˆ†äº«ã€‚è¿™ä¸ªå·¥å…·ç«™çš„è§’åº¦æ¯”è¾ƒé«˜ï¼Œå¿½ç•¥äº†åº•å±‚çš„ä¸€äº›é…ç½®ï¼Œè®©ç”¨æˆ·äº†è§£p4çš„é—¨æ§›å˜ä½ï¼Œç›´æ¥å¼€å§‹è®¾è®¡p4ç¨‹åºã€‚ğŸ‘Œ p4lang/p4appçš„é•œåƒç»“æ„Docker é•œåƒæ˜¯åˆ†å±‚ç»“æ„ä»¥Ubuntu 16.04ä¸ºbaseé•œåƒä¾æ¬¡æ„å»ºï¼Œp4appä¸ºæœ€é¡¶å±‚.å¯¹äºå¦‚ä½•æ„å»ºè¿™äº›é•œåƒï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹p4appçš„Dockerfile.ğŸ’ª p4app p4c pi bmv2 third-party ubuntuï¼š16.04 å®‰è£…p4app å‰æä¿è¯æœºå™¨ä¸Šå®‰è£…äº†docker ğŸ–¥ä¸‹è½½githubçš„p4appæºç 1234git clone https://github.com/p4lang/p4app.git cd p4appsudo cp p4app /usr/local/binp4app run examples/simple_router.p4app ğŸ˜˜ å…¶ä»–å…·ä½“çš„è¯´æ˜å‚ç…§https://github.com/p4lang/p4appä¸­README.mdçš„è¯´æ˜ã€‚ ä¸‹é¢è®¨è®ºä¸‹p4c å’Œ p4c-bm çš„å…³ç³»ä»¥åŠ p4factory å’Œ p4app çš„å…³ç³»ä»sdnlabç½‘ç«™ä¸Šå¸–å­çš„ç†è§£ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼šP4è¯­è¨€(P4_14)æå‡ºä¸ä¹…æ—¶ï¼Œp4-hilrï¼šhttps://github.com/p4lang/p4-hliræ˜¯å®ƒçš„ç¼–è¯‘å™¨ï¼ŒP4è½¯ä»¶äº¤æ¢æœºæ˜¯BMv1: https://github.com/p4lang/p4c-behavioralï¼›åŒæ—¶ï¼Œä¸ºä½¿å¤§å®¶æ›´å¥½çš„ä¸Šæ‰‹P4è¯­è¨€ï¼Œæä¾›äº†p4factoryå’Œtutorialsè¿™ä¸¤ä¸ªä»“åº“ï¼›åæ¥P4ç¤¾åŒºä½¿ç”¨C++é‡å†™äº†BMv1è½¯ä»¶äº¤æ¢æœºï¼Œå½¢æˆç°åœ¨é€šç”¨çš„P4è½¯ä»¶äº¤æ¢æœºBMv2ï¼šğŸ–¥https://github.com/p4lang/behavioral-modelï¼Œå¹¶å¯¹p4-hilrç¼–è¯‘å™¨åšäº†å¯¹åº”çš„æ‹“å±•ï¼Œå½¢æˆp4c-bmç¼–è¯‘å™¨ï¼Œp4c-bm åªæ”¯æŒ p4-14 è€Œä¸”æŒ‡é’ˆå¯¹ bmv2 è¿™ä¸ªç›®æ ‡ï¼Œè€Œ p4c å¯ä»¥æ”¯æŒ p4-14 å’Œ p4-16ï¼Œè€Œä¸”åŒ…å«äº†å¤šä¸ªåç«¯ç¼–è¯‘å™¨ã€‚16å¹´ï¼Œä¸ºè§£å†³P4_14è¯­è¨€çš„è¯­æ³•é—®é¢˜å’Œé™åˆ¶ï¼Œç¤¾åŒºå¼€å‘äº†P4_16è¯­è¨€ï¼Œå¹¶åŸºäºP4_16è¯­è¨€åšäº†æ–°çš„ç¼–è¯‘å™¨p4cï¼›p4cæ˜¯P4è¯­è¨€çš„å‰ç«¯ç¼–è¯‘å™¨ï¼ŒğŸŒæ—¢æ”¯æŒp4_16è¯­è¨€ä¹Ÿæ”¯æŒp4_14è¯­è¨€ï¼ŒåŒæ—¶å…è®¸å„å¤§å‚å•†å¼€å‘æ¶æ„ç›¸å…³çš„çš„åç«¯ç¼–è¯‘å™¨ï¼Œå³å¯¹åº”äºebpfã€bmv2ã€tofinoã€NetFPGAç­‰æ¶æ„çš„åç«¯ç¼–è¯‘å™¨ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒP4è¯­è¨€å®˜æ–¹æ•™ç¨‹Tutorialæ˜¯ä¸æ–­æ›´æ–°çš„ï¼Œè€Œp4factoryä¸å†è¢«å®˜æ–¹ç»´æŠ¤ï¼Œæ‰€ä»¥å¦‚æœè¦ä¸Šæ‰‹P4çš„è¯å»ºè®®ä»Tutorialå¼€å§‹ã€‚p4appæ˜¯é€šè¿‡dockerç¯å¢ƒè¿è¡ŒP4å®éªŒçš„ä¸€ä¸ªä»“åº“ï¼Œå¯ä»¥å‚è€ƒä¸Šé¢çš„æ•™ç¨‹æˆ–è€…æƒ³å¤šäº†è§£å¯ä»¥è®¿é—®å­™å‹‡å³°è€å¸ˆçš„åšå®¢ï¼šsunyongfeng.com/201705/networks/p4/repo_p4app.htmlã€‚","link":"/2019/10/24/P4app_Docker/"},{"title":"icarus_configure","text":"è‡ªå®šä¹‰icarusä¸»é¢˜çš„é…ç½®ï¼Œä½¿ä¸ªäººåšå®¢çœ‹èµ·æ¥å¾ˆèˆ’æœã€‚ é›ªèŠ±ç‰¹æ•ˆ åœ¨/themes/icarus/source/js/ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªsrcç›®å½•ï¼Œåœ¨srcç›®å½•ä¸­æ–°å»ºsnow.jsæ–‡ä»¶ï¼ŒæŠŠä¸‹é¢çš„ä»£ç å†™åˆ°snow.jsæ–‡ä»¶ä¸­ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126function snowFall(snow) { /* å¯é…ç½®å±æ€§ */ snow = snow || {}; this.maxFlake = snow.maxFlake || 200; /* æœ€å¤šç‰‡æ•° */ this.flakeSize = snow.flakeSize || 10; /* é›ªèŠ±å½¢çŠ¶ */ this.fallSpeed = snow.fallSpeed || 1; /* å è½é€Ÿåº¦ */}/* å…¼å®¹å†™æ³• */requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame || function(callback) { setTimeout(callback, 1000 / 60); };cancelAnimationFrame = window.cancelAnimationFrame || window.mozCancelAnimationFrame || window.webkitCancelAnimationFrame || window.msCancelAnimationFrame || window.oCancelAnimationFrame;/* å¼€å§‹ä¸‹é›ª */snowFall.prototype.start = function(){ /* åˆ›å»ºç”»å¸ƒ */ snowCanvas.apply(this); /* åˆ›å»ºé›ªèŠ±å½¢çŠ¶ */ createFlakes.apply(this); /* ç”»é›ª */ drawSnow.apply(this)}/* åˆ›å»ºç”»å¸ƒ */function snowCanvas() { /* æ·»åŠ Domç»“ç‚¹ */ var snowcanvas = document.createElement(\"canvas\"); snowcanvas.id = \"snowfall\"; snowcanvas.width = window.innerWidth; snowcanvas.height = document.body.clientHeight; snowcanvas.setAttribute(\"style\", \"position:absolute; top: 0; left: 0; z-index: 1; pointer-events: none;\"); document.getElementsByTagName(\"body\")[0].appendChild(snowcanvas); this.canvas = snowcanvas; this.ctx = snowcanvas.getContext(\"2d\"); /* çª—å£å¤§å°æ”¹å˜çš„å¤„ç† */ window.onresize = function() { snowcanvas.width = window.innerWidth; /* snowcanvas.height = window.innerHeight */ }}/* é›ªè¿åŠ¨å¯¹è±¡ */function flakeMove(canvasWidth, canvasHeight, flakeSize, fallSpeed) { this.x = Math.floor(Math.random() * canvasWidth); /* xåæ ‡ */ this.y = Math.floor(Math.random() * canvasHeight); /* yåæ ‡ */ this.size = Math.random() * flakeSize + 2; /* å½¢çŠ¶ */ this.maxSize = flakeSize; /* æœ€å¤§å½¢çŠ¶ */ this.speed = Math.random() * 1 + fallSpeed; /* å è½é€Ÿåº¦ */ this.fallSpeed = fallSpeed; /* å è½é€Ÿåº¦ */ this.velY = this.speed; /* Yæ–¹å‘é€Ÿåº¦ */ this.velX = 0; /* Xæ–¹å‘é€Ÿåº¦ */ this.stepSize = Math.random() / 30; /* æ­¥é•¿ */ this.step = 0 /* æ­¥æ•° */}flakeMove.prototype.update = function() { var x = this.x, y = this.y; /* å·¦å³æ‘†åŠ¨(ä½™å¼¦) */ this.velX *= 0.98; if (this.velY = canvas.width || this.x = canvas.height || this.y","link":"/2019/10/10/icarus-configure/"},{"title":"python_loop_break","text":"æœ¬æ–‡æ€»ç»“python è¯­è¨€å®šæ—¶è·³å‡ºå¾ªç¯çš„æ–¹æ¡ˆï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š å¾ªç¯ä¸­æ— é˜»å¡çš„å¯èƒ½è¿™ç§æƒ…å†µæ¯”è¾ƒç®€å•ï¼Œå¯ä»¥ç›´æ¥ç”¨æ—¶é—´å·®çš„åˆ¤æ–­æ˜¯å¦è·³å‡ºå³å¯ï¼š12345import timet_end = time.time() + 60 * 15while time.time() < t_end: # do whatever you doä½†æ˜¯å¿…é¡»ä¿è¯ä¸å­˜åœ¨é˜»å¡çš„å¯èƒ½ å¾ªç¯ä¸­å¯èƒ½ä¼šå‘ç”Ÿé˜»å¡è¿™ç§å°±æ¯”è¾ƒå¤æ‚ï¼Œå› ä¸ºå¯èƒ½å¾ªç¯ä¼šé˜»å¡åœ¨ç‰¹å®šçš„è¯­å¥ï¼Œæ‰€ä»¥æ— æ³•ç”¨ä¸Šé¢çš„æ–¹æ³•æ¥å®ç°ï¼Œå¿…é¡»è¦å¦å¼€ä¸€çº¿ç¨‹æ¥ä½¿å¾ªç¯çº¿ç¨‹å’Œè®¡æ—¶åˆ¤æ–­çº¿ç¨‹åŒæ—¶è¿›è¡Œï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰é˜»ç¢äº†ã€‚ä¸‹é¢çš„ä»£ç æ˜¯æˆ‘æŸ¥èµ„æ–™é‡‡å–çš„æ–¹æ¡ˆï¼š1234567891011121314151617181920from multiprocessing import Processimport timedef task(msg): while 1: print ('hello, %s' % msg) time.sleep(1) pass if __name__ == '__main__': p = Process(target=task, args=('world',)) p.start() p.join(0.15) if p.is_alive(): print('Process: %s is running' % p.pid) p.terminate() å°½ç®¡è¿™ä¸ªtaskä¸­çš„å¾ªç¯ä¸åŒ…æ‹¬é˜»å¡çš„å¯èƒ½ï¼Œä½†æ˜¯è¿™æ®µä»£ç æ˜¯å¯ä»¥å®Œå…¨åº”å¯¹å‘ç”Ÿé˜»å¡çš„æƒ…å†µã€‚","link":"/2019/10/10/python-loop-break/"},{"title":"virtualbox-build-topo","text":"å¤šå°è™šæ‹Ÿæœºæ­å»ºç½‘ç»œæ‹“æ‰‘åˆ©ç”¨å¤šå°è™šæ‹Ÿæœºæ­å»ºå½¼æ­¤ä¹‹é—´çš„æ‹“æ‰‘å…³ç³»ï¼Œè¿›è¡Œä¸€äº›è¯•éªŒï¼Œè€Œä¸é™äºå®é™…äº¤æ¢è®¾å¤‡æ•°é‡çš„é™åˆ¶ã€‚ åœ¨virtualboxè½¯ä»¶ä¸Šåˆ›å»ºå¤šå°è™šæ‹Ÿæœºï¼Œæˆ‘ç”¨ä¸‰ä¸ªæ¥è¯•éªŒï¼Œä¸¤å°ä½œä¸ºä¸»æœºï¼Œä¸€å°ä½œä¸ºè·¯ç”± è¿›è¡Œä¸¤å°ä¸»æœºçš„ç½‘ç»œé…ç½® é…ç½®è·¯ç”±å™¨ ä¸»æœºçš„é…ç½®é€‰æ‹©ç›¸åº”çš„è™šæ‹Ÿæœº1å³é”®ç‚¹å‡» é€‰æ‹©è®¾ç½®-ç½‘ç»œ å¡«å†™è¿æ¥æ–¹å¼ä¸ºå†…éƒ¨ç½‘ç»œï¼Œå¹¶è®¾å®šç•Œé¢åç§°ä¸ºinet-1 é€‰æ‹©ç›¸åº”çš„è™šæ‹Ÿæœº2å³é”®ç‚¹å‡» é€‰æ‹©è®¾ç½®-ç½‘ç»œ å¡«å†™è¿æ¥æ–¹å¼ä¸ºå†…éƒ¨ç½‘ç»œï¼Œå¹¶è®¾å®šç•Œé¢åç§°ä¸ºinet-2 è·¯ç”±å™¨çš„é…ç½®é€‰æ‹©è·¯ç”±å™¨çš„3å·è™šæ‹Ÿæœºå³é”®ç‚¹å‡» é€‰æ‹©è®¾ç½®-ç½‘ç»œ å¡«å†™ç½‘å¡1è¿æ¥æ–¹å¼ä¸ºå†…éƒ¨ç½‘ç»œï¼Œå¹¶è®¾å®šç•Œé¢åç§°ä¸ºinet-1 åŒæ ·è®¾å®šç½‘å¡2ä½å†…éƒ¨ç½‘ç»œï¼Œinet-2 å¼€å¯ä¸‰å°è™šæ‹Ÿæœºåœ¨1,2è™šæ‹Ÿæœºä¸Šè®¾å®šç½‘å¡çš„IPåœ°å€å’Œé»˜è®¤ç½‘å…³ 12sudo ifconfig enp0s3 192.168.1.2 netmask 255.255.255.0sudo route add default gw 192.168.1.1 åŒæ ·è®¾å®šå¦ä¸€ä¸»æœºï¼Œä¿è¯ä¸å†åŒä¸€ç½‘æ®µï¼Œæ¯”å¦‚è®¾å¦ä¸€å°ipä¸º192.168.2.2ï¼Œç½‘å…³ä¸º192.168.2.1ï¼Œè¿™æ ·ä¸¤å°ä¸»æœºå°±è®¾å®šé…ç½®å®Œæ¯•ï¼Œä½†æ˜¯æ­¤æ—¶h1 æ— æ³•ping é€šh2 åœ¨3çš„è·¯ç”±å™¨è™šæ‹Ÿæœºä¸ŠåŒæ ·ä¸ºä¸¤å¼ ç½‘å¡è®¾å®šIPï¼Œç½‘å¡ä¸€ä¸º192.168.1.1ï¼Œå¦ä¸€ä¸º192.168.2.1ä¸‹é¢éœ€è¦è®¾ç½®è½¬å‘è·¯ç”±è¡¨,å…è®¸ubuntuè½¬å‘123sudo ip route add 192.168.2.0/24 via 192.168.2.1sudo ip route add 192.168.1.0/24 via 192.168.1.1echo 1 > /proc/sys/net/ipv4/ip_forward ç„¶åh1å°±å¯ä»¥pingé€šh2äº†ã€‚","link":"/2019/10/17/virtualbox-build-topo/"}],"tags":[{"name":"http","slug":"http","link":"/tags/http/"},{"name":"P4","slug":"P4","link":"/tags/P4/"},{"name":"Hexo","slug":"Hexo","link":"/tags/Hexo/"},{"name":"Python","slug":"Python","link":"/tags/Python/"},{"name":"networks","slug":"networks","link":"/tags/networks/"}],"categories":[{"name":"http","slug":"http","link":"/categories/http/"},{"name":"networks","slug":"networks","link":"/categories/networks/"},{"name":"P4","slug":"P4","link":"/categories/P4/"},{"name":"Hexo","slug":"Hexo","link":"/categories/Hexo/"},{"name":"Python","slug":"Python","link":"/categories/Python/"}]}